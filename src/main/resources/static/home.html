<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Home</title>

    <script src="https://unpkg.com/htmx.org@1.9.3"></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/client-side-templates.js"></script>
    <script src="https://unpkg.com/nunjucks@latest"></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/json-enc.js"></script>
    <script src="https://unpkg.com/htmx.org/dist/ext/response-targets.js"></script>
    <script src="templates/javascript-helpers.js"></script>
    <link rel="stylesheet" href="bulma.css">
</head>

<body hx-ext="client-side-templates,response-targets,json-enc">
<div hx-trigger="load"
     hx-get="http://localhost:8080/user"
     nunjucks-template="main-template"
     hx-target-4*="#main"
     hx-target="#main"
     id="main">
</div>

<template id="main-template">

    {% include "templates/check-session-invalid.html" %}
    {% include "templates/navbar.html" %}
    {% if admin %}
    <div hx-get="http://localhost:8080/posts"
         hx-target="#adminOutput"
         nunjucks-template="templateAdmin"
         hx-trigger="load">
    </div>

    <section id="adminOutput"></section>

    {% else %}
    <div hx-get="http://localhost:8080/posts"
         hx-target="#userOutput"
         nunjucks-template="templateUser"
         hx-trigger="load">
    </div>

    <section id="userOutput"></section>

    {% endif %}

</template>

<template id="templateAdmin">

    {% for blogPost in blogPostList %}


    <div class="container">
        ADMIN!!!
        <div class="card">
            <div class="card-content">
                <article class="media">
                    <figure class="media-left">
                        <p class="image is-64x64">
                            <img src="https://bulma.io/images/placeholders/128x128.png">
                        </p>
                    </figure>
                    <div class="media-content">
                        <div class="content">
                            <p>
                                <strong>{{blogPost.user.username}}</strong> <small>{{blogPost.blogPostTime}}</small>
                                <br>
                                {{blogPost.content}}
                            </p>
                        </div>
                        <article class="media">
                            <figure class="media-left">
                                <p class="image is-64x64">
                                    <img src="https://bulma.io/images/placeholders/128x128.png">
                                </p>
                            </figure>
                            <div class="media-content">
                                <div class="field">
                                    <p class="control">
                                        <textarea class="textarea is-small" placeholder="Add a comment..."></textarea>
                                    </p>
                                </div>
                                <nav class="level">
                                    <div class="level-left">
                                        <div class="level-item">
                                            <a class="button is-info">Comment</a>
                                        </div>
                                    </div>
                                </nav>
                            </div>
                        </article>
                    </div>
                    <div class="media-right">
                        <button class="edit"></button>
                        <button class="delete"></button>
                    </div>

                </article>
            </div>
            <footer class="card-footer">
                <a href="#" class="card-footer-item">Edit</a>
            </footer>
        </div>
        <br>
    </div>
    {% endfor %}
</template>

<template id="templateUser">

    {% for blogPost in blogPostList %}

    <div class="container">
        USER!!!
        <div class="card">
            <div class="card-content">
                <article class="media">
                    <figure class="media-left">
                        <p class="image is-64x64">
                            <img src="https://bulma.io/images/placeholders/128x128.png">
                        </p>
                    </figure>
                    <div class="media-content">
                        <div class="content">
                            <p>
                                <strong>{{blogPost.user.username}}</strong> <small>{{blogPost.blogPostTime}}</small>
                                <br>
                                {{blogPost.content}}
                            </p>
                        </div>
                        <article class="media">
                            <figure class="media-left">
                                <p class="image is-64x64">
                                    <img src="https://bulma.io/images/placeholders/128x128.png">
                                </p>
                            </figure>
                            <div class="media-content">
                                <div class="field">
                                    <p class="control">
                                        <textarea class="textarea is-small" placeholder="Add a comment..."></textarea>
                                    </p>
                                </div>
                                <nav class="level">
                                    <div class="level-left">
                                        <div class="level-item">
                                            <a class="button is-info">Comment</a>
                                        </div>
                                    </div>
                                </nav>
                            </div>
                        </article>
                    </div>
                </article>
            </div>
        </div>
        <br>
    </div>
    {% endfor %}

</template>
</body>
</html>